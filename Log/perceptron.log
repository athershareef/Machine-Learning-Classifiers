> 
> perceptron <-lm(Donated~ ., data=prtrain)
> cv.lm(data=prtrain, perceptron, m=5)
Analysis of Variance Table

Response: Donated
                   Df Sum Sq Mean Sq F value  Pr(>F)    
Recency..Months.    1    7.2    7.16   46.28 2.8e-11 ***
Frequency..times.   1    3.6    3.63   23.42 1.7e-06 ***
Time..months.       1    1.3    1.34    8.67  0.0034 ** 
Residuals         519   80.3    0.15                    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1



fold 1 
Observations in test set: 104 
                430      742    68    320     467    235   587    547     728    313    341    701     739    52    411    337     494
Predicted    0.0919 -0.01868  0.32  0.182  0.0379  0.248 0.284  0.413  0.0557  0.212  0.164  0.107  0.0317 0.392  0.116  0.173 -0.1177
cvpred       0.1005  0.00406  0.31  0.188  0.0535  0.255 0.275  0.422  0.0649  0.223  0.170  0.115  0.0428 0.394  0.120  0.176 -0.0972
Donated      0.0000  0.00000  0.00  0.000  0.0000  0.000 1.000  0.000  0.0000  0.000  0.000  0.000  0.0000 1.000  0.000  0.000  0.0000
CV residual -0.1005 -0.00406 -0.31 -0.188 -0.0535 -0.255 0.725 -0.422 -0.0649 -0.223 -0.170 -0.115 -0.0428 0.606 -0.120 -0.176  0.0972
              178    554   539    110     465    697      8     708    171    255   154   181    131    562     88     438     31    390
Predicted   0.269  0.296 0.344  0.314  0.0557  0.125  0.458  0.0593  0.284  0.311 0.284 0.266  0.284  0.308  0.284  0.0740  0.437  0.107
cvpred      0.268  0.289 0.344  0.318  0.0649  0.131  0.459  0.0685  0.275  0.325 0.275 0.263  0.282  0.312  0.277  0.0824  0.442  0.121
Donated     1.000  0.000 1.000  0.000  0.0000  0.000  0.000  0.0000  0.000  0.000 1.000 1.000  0.000  0.000  0.000  0.0000  0.000  0.000
CV residual 0.732 -0.289 0.656 -0.318 -0.0649 -0.131 -0.459 -0.0685 -0.275 -0.325 0.725 0.737 -0.282 -0.312 -0.277 -0.0824 -0.442 -0.121
                79   515   521    152    409    90    560    646    660    205    214     83     84   46    202    240    439     472
Predicted    0.302 0.518 0.410  0.275  0.116 0.329  0.299  0.164  0.191  0.287  0.260  0.314  0.314 0.38  0.242  0.254  0.134  0.0289
cvpred       0.293 0.524 0.412  0.275  0.120 0.328  0.301  0.167  0.201  0.295  0.253  0.308  0.308 0.38  0.245  0.262  0.162  0.0433
Donated      0.000 1.000 1.000  0.000  0.000 1.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000 1.00  0.000  0.000  0.000  0.0000
CV residual -0.293 0.476 0.588 -0.275 -0.120 0.672 -0.301 -0.167 -0.201 -0.295 -0.253 -0.308 -0.308 0.62 -0.245 -0.262 -0.162 -0.0433
               677    21   243     22    551    286   130   290    420      487    184    175   623    103    128     740    219   262
Predicted    0.152 0.326 0.245  0.428  0.296  0.191 0.284 0.173  0.110 -0.01869  0.272  0.284 0.242  0.344  0.284  0.0170  0.260 0.302
cvpred       0.157 0.318 0.242  0.430  0.292  0.191 0.276 0.177  0.116  0.00154  0.282  0.275 0.240  0.346  0.280  0.0335  0.253 0.317
Donated      0.000 1.000 1.000  0.000  0.000  0.000 1.000 1.000  0.000  0.00000  0.000  0.000 1.000  0.000  0.000  0.0000  0.000 1.000
CV residual -0.157 0.682 0.758 -0.430 -0.292 -0.191 0.724 0.823 -0.116 -0.00154 -0.282 -0.275 0.760 -0.346 -0.280 -0.0335 -0.253 0.683
               233   569     493    381     744     449    634   709      488    651    418    343    506     466     738    141    246
Predicted    0.260 0.287 -0.0877  0.140  0.0109  0.0771  0.323 0.119  0.00495  0.200  0.116  0.155 0.9566  0.0351  0.0317  0.260  0.230
cvpred       0.253 0.287 -0.0669  0.142  0.0244  0.0974  0.339 0.122  0.02032  0.197  0.120  0.164 0.9833  0.0515  0.0428  0.265  0.231
Donated      0.000 1.000  0.0000  0.000  0.0000  0.0000  0.000 1.000  0.00000  0.000  0.000  0.000 1.0000  0.0000  0.0000  0.000  0.000
CV residual -0.253 0.713  0.0669 -0.142 -0.0244 -0.0974 -0.339 0.878 -0.02032 -0.197 -0.120 -0.164 0.0167 -0.0515 -0.0428 -0.265 -0.231
               414    335      490       745    533    513    221    665     477    293    228     437     47   527    207    75
Predicted    0.101  0.140 -0.02489 -0.013003  0.356  0.446  0.260  0.176  0.0112  0.197  0.248  0.0678  0.374 0.338  0.266 0.302
cvpred       0.111  0.145 -0.00919  0.000607  0.356  0.446  0.253  0.175  0.0311  0.200  0.244  0.0780  0.374 0.333  0.259 0.293
Donated      0.000  0.000  0.00000  0.000000  0.000  0.000  0.000  0.000  0.0000  0.000  0.000  0.0000  0.000 1.000  0.000 1.000
CV residual -0.111 -0.145  0.00919 -0.000607 -0.356 -0.446 -0.253 -0.175 -0.0311 -0.200 -0.244 -0.0780 -0.374 0.667 -0.259 0.707

Sum of squares = 14.2    Mean square = 0.14    n = 104 

fold 2 
Observations in test set: 105 
               212    133    40   289     398    58    239   370    125   613    393    643   509    172    234    698    382     70
Predicted    0.260  0.284 0.350 0.194  0.0888 0.350  0.233 0.140  0.284 0.260  0.119  0.206 0.614  0.284  0.269  0.125  0.140  0.338
cvpred       0.257  0.284 0.341 0.188  0.0824 0.347  0.253 0.142  0.290 0.257  0.157  0.210 0.581  0.281  0.265  0.132  0.137  0.348
Donated      0.000  0.000 1.000 1.000  0.0000 1.000  0.000 1.000  0.000 1.000  0.000  0.000 1.000  0.000  0.000  0.000  0.000  0.000
CV residual -0.257 -0.284 0.659 0.812 -0.0824 0.653 -0.253 0.858 -0.290 0.743 -0.157 -0.210 0.419 -0.281 -0.265 -0.132 -0.137 -0.348
               249   117    183    155     4     92    189    361    565    188    238    378    351    91    628    126    119    323
Predicted    0.200 0.296  0.257  0.284 0.611  0.284  0.341  0.149  0.326  0.266  0.254  0.140  0.176 0.284  0.200  0.284  0.272  0.179
cvpred       0.193 0.308  0.271  0.281 0.576  0.278  0.344  0.158  0.344  0.270  0.256  0.137  0.173 0.278  0.193  0.293  0.294  0.184
Donated      0.000 1.000  0.000  0.000 1.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000 1.000  0.000  0.000  0.000  0.000
CV residual -0.193 0.692 -0.271 -0.281 0.424 -0.278 -0.344 -0.158 -0.344 -0.270 -0.256 -0.137 -0.173 0.722 -0.193 -0.293 -0.294 -0.184
               528    191    445     731    362     722    344    372     97    443   577     464    495     453    296    210    204
Predicted    0.434  0.260  0.107  0.0438  0.161  0.0438  0.176  0.137  0.407  0.077 0.266  0.0557 -0.136  0.0408  0.152  0.215  0.242
cvpred       0.432  0.275  0.116  0.0467  0.165  0.0430  0.173  0.141  0.415  0.104 0.274  0.0525 -0.091  0.0379  0.194  0.207  0.262
Donated      0.000  0.000  0.000  0.0000  0.000  0.0000  0.000  0.000  0.000  0.000 1.000  0.0000  0.000  0.0000  0.000  0.000  0.000
CV residual -0.432 -0.275 -0.116 -0.0467 -0.165 -0.0430 -0.173 -0.141 -0.415 -0.104 0.726 -0.0525  0.091 -0.0379 -0.194 -0.207 -0.262
               252     455    357    104   179     93     428   524    327    328    599    229    664   145    57    315    157   518
Predicted    0.185  0.0557  0.164  0.308 0.269  0.284  0.0562 0.386  0.191  0.248  0.266  0.260  0.161 0.269 0.362  0.200  0.284 0.747
cvpred       0.224  0.0525  0.162  0.311 0.279  0.278  0.0874 0.386  0.217  0.260  0.274  0.257  0.183 0.267 0.352  0.197  0.281 0.706
Donated      0.000  0.0000  0.000  0.000 1.000  0.000  0.0000 1.000  0.000  0.000  0.000  0.000  0.000 1.000 1.000  0.000  0.000 1.000
CV residual -0.224 -0.0525 -0.162 -0.311 0.721 -0.278 -0.0874 0.614 -0.217 -0.260 -0.274 -0.257 -0.183 0.733 0.648 -0.197 -0.281 0.294
              319    45     710     14    567    135    265   339    388     711    620     726     421   253     2     714    512    248
Predicted   0.185 0.521  0.0950  0.446  0.287  0.266  0.194 0.176  0.140  0.0557  0.260  0.0557  0.0737 0.254 0.512  0.0413  0.452  0.251
cvpred      0.203 0.503  0.0957  0.438  0.292  0.298  0.221 0.173  0.137  0.0488  0.257  0.0525  0.0686 0.250 0.489  0.0728  0.433  0.273
Donated     1.000 1.000  0.0000  0.000  0.000  0.000  0.000 1.000  0.000  0.0000  0.000  0.0000  0.0000 1.000 1.000  0.0000  0.000  0.000
CV residual 0.797 0.497 -0.0957 -0.438 -0.292 -0.298 -0.221 0.827 -0.137 -0.0488 -0.257 -0.0525 -0.0686 0.750 0.511 -0.0728 -0.433 -0.273
               156     727   541    199    508    564     720   322   329   517    406    468    689    600    310    667
Predicted    0.284  0.0530 0.326  0.266  0.461  0.320  0.0621 0.170 0.170 0.341  0.107  0.035  0.131  0.323  0.155  0.176
cvpred       0.281  0.0519 0.327  0.256  0.440  0.318  0.0709 0.187 0.168 0.331  0.119  0.046  0.136  0.306  0.147  0.173
Donated      0.000  0.0000 1.000  0.000  0.000  0.000  0.0000 1.000 1.000 1.000  0.000  0.000  0.000  0.000  0.000  0.000
CV residual -0.281 -0.0519 0.673 -0.256 -0.440 -0.318 -0.0709 0.813 0.832 0.669 -0.119 -0.046 -0.136 -0.306 -0.147 -0.173

Sum of squares = 15.7    Mean square = 0.15    n = 105 

fold 3 
Observations in test set: 105 
                86      1    354    169    558    680   222     50    648     396    258    632    375    368    367    294   101    657
Predicted    0.326  1.173  0.170  0.284  0.302  0.146 0.260  0.308  0.215  0.1134  0.242  0.248  0.134  0.140  0.266  0.200 0.338  0.203
cvpred       0.339  1.232  0.178  0.302  0.314  0.152 0.276  0.327  0.218  0.0997  0.251  0.257  0.136  0.143  0.279  0.207 0.352  0.207
Donated      0.000  1.000  0.000  0.000  0.000  0.000 1.000  0.000  0.000  0.0000  0.000  0.000  0.000  0.000  0.000  0.000 1.000  0.000
CV residual -0.339 -0.232 -0.178 -0.302 -0.314 -0.152 0.724 -0.327 -0.218 -0.0997 -0.251 -0.257 -0.136 -0.143 -0.279 -0.207 0.648 -0.207
               245    134    193    617    748     460   120     429    353     405     501    182     391     440   164    598    349
Predicted    0.218  0.287  0.257  0.260 -0.556  0.0557 0.293  0.0648  0.155  0.0861  1.0405  0.242  0.1071  0.0294 0.284  0.263  0.176
cvpred       0.232  0.296  0.263  0.276 -0.584  0.0612 0.289  0.0701  0.154  0.0767  1.0934  0.257  0.0993  0.0084 0.302  0.268  0.188
Donated      0.000  0.000  0.000  0.000  0.000  0.0000 1.000  0.0000  0.000  0.0000  1.0000  0.000  0.0000  0.0000 1.000  0.000  0.000
CV residual -0.232 -0.296 -0.263 -0.276  0.584 -0.0612 0.711 -0.0701 -0.154 -0.0767 -0.0934 -0.257 -0.0993 -0.0084 0.698 -0.268 -0.188
              385    159    211    610    64   544     35    592   324    674     94   619     729    215    201     30   386    585
Predicted    0.14  0.284  0.260  0.260 0.320 0.284  0.458  0.335 0.200  0.227  0.284 0.260  0.0557  0.260  0.236  0.377  0.11  0.284
cvpred       0.15  0.302  0.276  0.276 0.338 0.302  0.471  0.351 0.204  0.225  0.302 0.276  0.0612  0.276  0.236  0.398  0.10  0.302
Donated      0.00  0.000  0.000  0.000 1.000 1.000  0.000  0.000 1.000  0.000  0.000 1.000  0.0000  0.000  0.000  0.000  0.00  0.000
CV residual -0.15 -0.302 -0.276 -0.276 0.662 0.698 -0.471 -0.351 0.796 -0.225 -0.302 0.724 -0.0612 -0.276 -0.236 -0.398 -0.10 -0.302
               570    403    250     425    242    534   520   197     69    140    163     484    137   563     746    118    213   692
Predicted    0.275  0.131  0.200  0.0831  0.419  0.320 0.404 0.281  0.341  0.281  0.284  0.0317  0.275 0.339 -0.0369  0.329  0.260  0.14
cvpred       0.279  0.136  0.214  0.0755  0.425  0.337 0.425 0.292  0.358  0.296  0.302  0.0359  0.282 0.333 -0.0501  0.334  0.276  0.15
Donated      0.000  0.000  0.000  0.0000  0.000  0.000 1.000 1.000  0.000  0.000  0.000  0.0000  0.000 1.000  0.0000  0.000  0.000  0.00
CV residual -0.279 -0.136 -0.214 -0.0755 -0.425 -0.337 0.575 0.708 -0.358 -0.296 -0.302 -0.0359 -0.282 0.667  0.0501 -0.334 -0.276 -0.15
              543    153    358    160     54    116     42    260     448    16    535    618   102    407     12     459    369     89
Predicted   0.422  0.278  0.152  0.284  0.398  0.569  0.338  0.290  0.0467 0.353  0.332  0.260 0.350  0.116  0.344  0.0557  0.155  0.284
cvpred      0.432  0.274  0.159  0.302  0.410  0.597  0.356  0.298  0.0512 0.373  0.346  0.276 0.351  0.124  0.365  0.0612  0.161  0.302
Donated     1.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.0000 1.000  0.000  0.000 1.000  0.000  0.000  0.0000  0.000  0.000
CV residual 0.568 -0.274 -0.159 -0.302 -0.410 -0.597 -0.356 -0.298 -0.0512 0.627 -0.346 -0.276 0.649 -0.124 -0.365 -0.0612 -0.161 -0.302
               616   511    309    41    699     478    338     363     457   216   264     734   190   306     716     48
Predicted    0.260 0.332  0.167 0.419  0.116  0.0317  0.161  0.1073  0.0557 0.260 0.224  0.0317 0.263 0.194  0.0472  0.308
cvpred       0.276 0.354  0.177 0.432  0.110  0.0359  0.156  0.0912  0.0612 0.276 0.226  0.0359 0.270 0.199  0.0337  0.327
Donated      0.000 1.000  0.000 1.000  0.000  0.0000  0.000  0.0000  0.0000 1.000 1.000  0.0000 1.000 1.000  0.0000  0.000
CV residual -0.276 0.646 -0.177 0.568 -0.110 -0.0359 -0.156 -0.0912 -0.0612 0.724 0.774 -0.0359 0.730 0.801 -0.0337 -0.327

Sum of squares = 15.1    Mean square = 0.14    n = 105 

fold 4 
Observations in test set: 105 
               557    43    109    148    218    271    174    259    416    340    195    180    346     470    326    653    208    635
Predicted    0.299 0.338  0.296  0.281  0.260  0.284  0.284  0.236  0.116  0.173  0.272  0.272  0.176  0.0232  0.158  0.176  0.206  0.191
cvpred       0.290 0.331  0.292  0.279  0.264  0.275  0.286  0.230  0.127  0.170  0.269  0.266  0.184  0.0120  0.166  0.178  0.179  0.197
Donated      0.000 1.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.0000  0.000  0.000  0.000  0.000
CV residual -0.290 0.669 -0.292 -0.279 -0.264 -0.275 -0.286 -0.230 -0.127 -0.170 -0.269 -0.266 -0.184 -0.0120 -0.166 -0.178 -0.179 -0.197
               659    37    267     491   523    578   151    176   376   662    55    314    574    236     26   505    350    650
Predicted    0.179 0.413  0.236 -0.0218 0.443  0.305 0.260  0.320 0.137  0.14 0.326  0.200  0.281  0.263  0.464 0.680  0.176  0.212
cvpred       0.180 0.388  0.232 -0.0285 0.421  0.293 0.238  0.309 0.134  0.15 0.321  0.207  0.279  0.241  0.440 0.627  0.184  0.203
Donated      0.000 1.000  0.000  0.0000 1.000  0.000 1.000  0.000 1.000  0.00 1.000  0.000  0.000  0.000  0.000 1.000  0.000  0.000
CV residual -0.180 0.612 -0.232  0.0285 0.579 -0.293 0.762 -0.309 0.866 -0.15 0.679 -0.207 -0.279 -0.241 -0.440 0.373 -0.184 -0.203
                737     427   127    747   561    397    194    257    612    364     59    589   519     480    419     461    198    525
Predicted    0.0317  0.0557 0.302 -0.160 0.320 0.0797  0.323  0.248  0.260  0.236  0.407  0.284 0.398  0.0317  0.116  0.0557  0.251  0.380
cvpred       0.0470  0.0698 0.284 -0.135 0.293 0.0925  0.309  0.246  0.264  0.224  0.367  0.286 0.381  0.0470  0.127  0.0698  0.235  0.366
Donated      0.0000  0.0000 1.000  0.000 1.000 1.0000  0.000  0.000  0.000  0.000  0.000  0.000 1.000  0.0000  0.000  0.0000  0.000  0.000
CV residual -0.0470 -0.0698 0.716  0.135 0.707 0.9075 -0.309 -0.246 -0.264 -0.224 -0.367 -0.286 0.619 -0.0470 -0.127 -0.0698 -0.235 -0.366
               631   336    311    62    20    73     717     374     431    230    348    278     721    115     730   640    263    611
Predicted    0.236 0.149  0.191 0.353 0.326 0.443  0.0648  0.1042  0.0951  0.260  0.176  0.218  0.0529  0.308  0.0319 0.170  0.245  0.260
cvpred       0.215 0.156  0.186 0.337 0.325 0.406  0.0761  0.0902  0.0875  0.264  0.184  0.210  0.0593  0.273  0.0398 0.141  0.240  0.264
Donated      0.000 1.000  0.000 1.000 1.000 1.000  0.0000  0.0000  0.0000  0.000  0.000  0.000  0.0000  0.000  0.0000 1.000  0.000  0.000
CV residual -0.215 0.844 -0.186 0.663 0.675 0.594 -0.0761 -0.0902 -0.0875 -0.264 -0.184 -0.210 -0.0593 -0.273 -0.0398 0.859 -0.240 -0.264
               274    17     7    220    29    377    571   383    579   713    638   552     51   538    603   537     27    280    85
Predicted    0.194 0.458 0.392  0.260 0.335  0.128  0.269  0.14  0.251 0.101  0.221 0.305  0.392 0.332  0.233 0.338  0.350  0.233 0.326
cvpred       0.176 0.430 0.383  0.264 0.331  0.122  0.252  0.15  0.252 0.103  0.217 0.291  0.369 0.321  0.236 0.324  0.344  0.221 0.314
Donated      0.000 1.000 1.000  0.000 1.000  0.000  0.000  0.00  0.000 1.000  0.000 1.000  0.000 1.000  0.000 1.000  0.000  0.000 1.000
CV residual -0.176 0.570 0.617 -0.264 0.669 -0.122 -0.252 -0.15 -0.252 0.897 -0.217 0.709 -0.369 0.679 -0.236 0.676 -0.344 -0.221 0.686
               269     735    568   244    77    173    435   550     442    590    652    277    496    347
Predicted    0.170  0.0317  0.299 0.356 0.314  0.284  0.101 0.320  0.0293  0.284  0.179  0.299 -0.151  0.176
cvpred       0.143  0.0470  0.277 0.323 0.308  0.286  0.103 0.308  0.0150  0.286  0.181  0.281 -0.140  0.184
Donated      0.000  0.0000  0.000 1.000 1.000  0.000  0.000 1.000  0.0000  0.000  0.000  0.000  0.000  0.000
CV residual -0.143 -0.0470 -0.277 0.677 0.692 -0.286 -0.103 0.692 -0.0150 -0.286 -0.181 -0.281  0.140 -0.184

Sum of squares = 17.2    Mean square = 0.16    n = 105 

fold 5 
Observations in test set: 104 
               379    24    107    332    604    318     80     712    629    209     9   288     95    649    18    299   282    691
Predicted    0.140 0.362  0.299  0.179  0.272  0.176  0.302  0.0859  0.197  0.248 0.416 0.203  0.371  0.188 0.479  0.164 0.188  0.140
cvpred       0.118 0.365  0.307  0.167  0.267  0.161  0.295  0.0666  0.195  0.241 0.426 0.188  0.376  0.174 0.503  0.145 0.173  0.118
Donated      0.000 1.000  0.000  0.000  0.000  0.000  0.000  0.0000  0.000  0.000 1.000 1.000  0.000  0.000 1.000  0.000 1.000  0.000
CV residual -0.118 0.635 -0.307 -0.167 -0.267 -0.161 -0.295 -0.0666 -0.195 -0.241 0.574 0.812 -0.376 -0.174 0.497 -0.145 0.827 -0.118
               675    685    656    601    273     401   266     3     718    325     25   531    200    231    663   530    588     715
Predicted    0.194  0.137  0.293  0.272  0.221  0.1007 0.215 0.554  0.0618  0.194  0.371 0.320  0.284  0.260  0.149 0.344  0.284  0.0621
cvpred       0.191  0.120  0.305  0.264  0.208  0.0772 0.209 0.583  0.0373  0.184  0.374 0.318  0.286  0.248  0.130 0.346  0.274  0.0438
Donated      0.000  0.000  0.000  0.000  0.000  0.0000 1.000 1.000  0.0000  0.000  0.000 1.000  0.000  0.000  0.000 1.000  0.000  0.0000
CV residual -0.191 -0.120 -0.305 -0.264 -0.208 -0.0772 0.791 0.417 -0.0373 -0.184 -0.374 0.682 -0.286 -0.248 -0.130 0.654 -0.274 -0.0438
               76     462    192   681    500    317   177    621    666    224    542    497    185    583    142   334     96    308
Predicted   0.302  0.0557  0.260 0.233 -0.580  0.182 0.233  0.230  0.176  0.260  0.350 -0.148  0.281  0.284  0.317 0.167  0.332  0.188
cvpred      0.295  0.0267  0.262 0.236 -0.664  0.165 0.222  0.231  0.157  0.248  0.361 -0.195  0.277  0.274  0.334 0.161  0.335  0.174
Donated     1.000  0.0000  0.000 1.000  0.000  0.000 1.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000 1.000  0.000  0.000
CV residual 0.705 -0.0267 -0.262 0.764  0.664 -0.165 0.778 -0.231 -0.157 -0.248 -0.361  0.195 -0.277 -0.274 -0.334 0.839 -0.335 -0.174
                705   510     424   576     399     719    303       483   504   553     66    144   575     394   522     402      733
Predicted    0.1157 0.482  0.0737 0.278  0.1042  0.0618  0.164  0.031721  1.03 0.308  0.419  0.272 0.281  0.0981 0.407  0.0978 0.031721
cvpred       0.0919 0.502  0.0472 0.278  0.0953  0.0373  0.145  0.000671  1.12 0.308  0.444  0.265 0.274  0.0846 0.421  0.0765 0.000671
Donated      0.0000 1.000  0.0000 1.000  0.0000  0.0000  0.000  0.000000  0.00 1.000  0.000  0.000 1.000  0.0000 1.000  0.0000 1.000000
CV residual -0.0919 0.498 -0.0472 0.722 -0.0953 -0.0373 -0.145 -0.000671 -1.12 0.692 -0.444 -0.265 0.726 -0.0846 0.579 -0.0765 0.999329
               633    132      6       741    65    287   295     395    695    150    608     410   641     63     61     417   196
Predicted    0.224  0.270  0.332  0.031721 0.311  0.227  0.20  0.1159  0.140  0.281  0.203  0.1157 0.221  0.359  0.347  0.1157 0.245
cvpred       0.215  0.284  0.328  0.000671 0.306  0.217  0.19  0.0986  0.118  0.274  0.206  0.0919 0.218  0.371  0.352  0.0919 0.244
Donated      0.000  0.000  0.000  0.000000 1.000  0.000  0.00  0.0000  0.000  0.000  0.000  0.0000 1.000  0.000  0.000  0.0000 1.000
CV residual -0.215 -0.284 -0.328 -0.000671 0.694 -0.217 -0.19 -0.0986 -0.118 -0.274 -0.206 -0.0919 0.782 -0.371 -0.352 -0.0919 0.756
               548    39    514       479     78   165    566     426    272   696    654     53       485    647    298   366
Predicted    0.305 0.431  0.488  0.031721  0.302 0.284  0.257  0.0801  0.224 0.125  0.206  0.344  0.031721  0.164  0.164 0.143
cvpred       0.300 0.452  0.509  0.000671  0.295 0.274  0.265  0.0643  0.215 0.114  0.196  0.346  0.000671  0.145  0.145 0.123
Donated      0.000 1.000  0.000  0.000000  0.000 1.000  0.000  0.0000  0.000 1.000  0.000  0.000  0.000000  0.000  0.000 1.000
CV residual -0.300 0.548 -0.509 -0.000671 -0.295 0.726 -0.265 -0.0643 -0.215 0.886 -0.196 -0.346 -0.000671 -0.145 -0.145 0.877

Sum of squares = 19.2    Mean square = 0.18    n = 104 

Overall (Sum over all 104 folds) 
   ms 
0.156 
Warning message:
In cv.lm(data = prtrain, perceptron, m = 5) : 

 As there is >1 explanatory variable, cross-validation
 predicted values for a fold are not a linear function
 of corresponding overall predicted values.  Lines that
 are shown for the different folds are approximate

> perceptron

Call:
lm(formula = Donated ~ ., data = prtrain)

Coefficients:
      (Intercept)   Recency..Months.  Frequency..times.      Time..months.  
           0.2278            -0.0729             0.1402            -0.0729  

> predicted_perceptron= ifelse(predict(perceptron,prtest)>0.7,1,0)
> confusionMatrix(predicted_perceptron,prtest$Donated)
Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 167  56
         1   0   2
                                        
               Accuracy : 0.751         
                 95% CI : (0.689, 0.806)
    No Information Rate : 0.742         
    P-Value [Acc > NIR] : 0.414         
                                        
                  Kappa : 0.05          
 Mcnemar's Test P-Value : 1.99e-13      
                                        
            Sensitivity : 1.0000        
            Specificity : 0.0345        
         Pos Pred Value : 0.7489        
         Neg Pred Value : 1.0000        
             Prevalence : 0.7422        
         Detection Rate : 0.7422        
   Detection Prevalence : 0.9911        
      Balanced Accuracy : 0.5172        
                                        
       'Positive' Class : 0             
                                        
> ROCp<-roc(prtest$Donated,predicted_perceptron)
> plot(ROCp)
> aucp<-auc(ROCp)
> aucp
Area under the curve: 0.517
> plot(ROCp)
> 


> 
> perceptron <-lm(Donated~ ., data=prtrain)
> cv.lm(data=prtrain, perceptron, m=5)
Analysis of Variance Table

Response: Donated
                   Df Sum Sq Mean Sq F value  Pr(>F)    
Recency..Months.    1    7.2    7.16   46.28 2.8e-11 ***
Frequency..times.   1    3.6    3.63   23.42 1.7e-06 ***
Time..months.       1    1.3    1.34    8.67  0.0034 ** 
Residuals         519   80.3    0.15                    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1



fold 1 
Observations in test set: 104 
                430      742    68    320     467    235   587    547     728    313    341    701     739    52    411    337     494
Predicted    0.0919 -0.01868  0.32  0.182  0.0379  0.248 0.284  0.413  0.0557  0.212  0.164  0.107  0.0317 0.392  0.116  0.173 -0.1177
cvpred       0.1005  0.00406  0.31  0.188  0.0535  0.255 0.275  0.422  0.0649  0.223  0.170  0.115  0.0428 0.394  0.120  0.176 -0.0972
Donated      0.0000  0.00000  0.00  0.000  0.0000  0.000 1.000  0.000  0.0000  0.000  0.000  0.000  0.0000 1.000  0.000  0.000  0.0000
CV residual -0.1005 -0.00406 -0.31 -0.188 -0.0535 -0.255 0.725 -0.422 -0.0649 -0.223 -0.170 -0.115 -0.0428 0.606 -0.120 -0.176  0.0972
              178    554   539    110     465    697      8     708    171    255   154   181    131    562     88     438     31    390
Predicted   0.269  0.296 0.344  0.314  0.0557  0.125  0.458  0.0593  0.284  0.311 0.284 0.266  0.284  0.308  0.284  0.0740  0.437  0.107
cvpred      0.268  0.289 0.344  0.318  0.0649  0.131  0.459  0.0685  0.275  0.325 0.275 0.263  0.282  0.312  0.277  0.0824  0.442  0.121
Donated     1.000  0.000 1.000  0.000  0.0000  0.000  0.000  0.0000  0.000  0.000 1.000 1.000  0.000  0.000  0.000  0.0000  0.000  0.000
CV residual 0.732 -0.289 0.656 -0.318 -0.0649 -0.131 -0.459 -0.0685 -0.275 -0.325 0.725 0.737 -0.282 -0.312 -0.277 -0.0824 -0.442 -0.121
                79   515   521    152    409    90    560    646    660    205    214     83     84   46    202    240    439     472
Predicted    0.302 0.518 0.410  0.275  0.116 0.329  0.299  0.164  0.191  0.287  0.260  0.314  0.314 0.38  0.242  0.254  0.134  0.0289
cvpred       0.293 0.524 0.412  0.275  0.120 0.328  0.301  0.167  0.201  0.295  0.253  0.308  0.308 0.38  0.245  0.262  0.162  0.0433
Donated      0.000 1.000 1.000  0.000  0.000 1.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000 1.00  0.000  0.000  0.000  0.0000
CV residual -0.293 0.476 0.588 -0.275 -0.120 0.672 -0.301 -0.167 -0.201 -0.295 -0.253 -0.308 -0.308 0.62 -0.245 -0.262 -0.162 -0.0433
               677    21   243     22    551    286   130   290    420      487    184    175   623    103    128     740    219   262
Predicted    0.152 0.326 0.245  0.428  0.296  0.191 0.284 0.173  0.110 -0.01869  0.272  0.284 0.242  0.344  0.284  0.0170  0.260 0.302
cvpred       0.157 0.318 0.242  0.430  0.292  0.191 0.276 0.177  0.116  0.00154  0.282  0.275 0.240  0.346  0.280  0.0335  0.253 0.317
Donated      0.000 1.000 1.000  0.000  0.000  0.000 1.000 1.000  0.000  0.00000  0.000  0.000 1.000  0.000  0.000  0.0000  0.000 1.000
CV residual -0.157 0.682 0.758 -0.430 -0.292 -0.191 0.724 0.823 -0.116 -0.00154 -0.282 -0.275 0.760 -0.346 -0.280 -0.0335 -0.253 0.683
               233   569     493    381     744     449    634   709      488    651    418    343    506     466     738    141    246
Predicted    0.260 0.287 -0.0877  0.140  0.0109  0.0771  0.323 0.119  0.00495  0.200  0.116  0.155 0.9566  0.0351  0.0317  0.260  0.230
cvpred       0.253 0.287 -0.0669  0.142  0.0244  0.0974  0.339 0.122  0.02032  0.197  0.120  0.164 0.9833  0.0515  0.0428  0.265  0.231
Donated      0.000 1.000  0.0000  0.000  0.0000  0.0000  0.000 1.000  0.00000  0.000  0.000  0.000 1.0000  0.0000  0.0000  0.000  0.000
CV residual -0.253 0.713  0.0669 -0.142 -0.0244 -0.0974 -0.339 0.878 -0.02032 -0.197 -0.120 -0.164 0.0167 -0.0515 -0.0428 -0.265 -0.231
               414    335      490       745    533    513    221    665     477    293    228     437     47   527    207    75
Predicted    0.101  0.140 -0.02489 -0.013003  0.356  0.446  0.260  0.176  0.0112  0.197  0.248  0.0678  0.374 0.338  0.266 0.302
cvpred       0.111  0.145 -0.00919  0.000607  0.356  0.446  0.253  0.175  0.0311  0.200  0.244  0.0780  0.374 0.333  0.259 0.293
Donated      0.000  0.000  0.00000  0.000000  0.000  0.000  0.000  0.000  0.0000  0.000  0.000  0.0000  0.000 1.000  0.000 1.000
CV residual -0.111 -0.145  0.00919 -0.000607 -0.356 -0.446 -0.253 -0.175 -0.0311 -0.200 -0.244 -0.0780 -0.374 0.667 -0.259 0.707

Sum of squares = 14.2    Mean square = 0.14    n = 104 

fold 2 
Observations in test set: 105 
               212    133    40   289     398    58    239   370    125   613    393    643   509    172    234    698    382     70
Predicted    0.260  0.284 0.350 0.194  0.0888 0.350  0.233 0.140  0.284 0.260  0.119  0.206 0.614  0.284  0.269  0.125  0.140  0.338
cvpred       0.257  0.284 0.341 0.188  0.0824 0.347  0.253 0.142  0.290 0.257  0.157  0.210 0.581  0.281  0.265  0.132  0.137  0.348
Donated      0.000  0.000 1.000 1.000  0.0000 1.000  0.000 1.000  0.000 1.000  0.000  0.000 1.000  0.000  0.000  0.000  0.000  0.000
CV residual -0.257 -0.284 0.659 0.812 -0.0824 0.653 -0.253 0.858 -0.290 0.743 -0.157 -0.210 0.419 -0.281 -0.265 -0.132 -0.137 -0.348
               249   117    183    155     4     92    189    361    565    188    238    378    351    91    628    126    119    323
Predicted    0.200 0.296  0.257  0.284 0.611  0.284  0.341  0.149  0.326  0.266  0.254  0.140  0.176 0.284  0.200  0.284  0.272  0.179
cvpred       0.193 0.308  0.271  0.281 0.576  0.278  0.344  0.158  0.344  0.270  0.256  0.137  0.173 0.278  0.193  0.293  0.294  0.184
Donated      0.000 1.000  0.000  0.000 1.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000 1.000  0.000  0.000  0.000  0.000
CV residual -0.193 0.692 -0.271 -0.281 0.424 -0.278 -0.344 -0.158 -0.344 -0.270 -0.256 -0.137 -0.173 0.722 -0.193 -0.293 -0.294 -0.184
               528    191    445     731    362     722    344    372     97    443   577     464    495     453    296    210    204
Predicted    0.434  0.260  0.107  0.0438  0.161  0.0438  0.176  0.137  0.407  0.077 0.266  0.0557 -0.136  0.0408  0.152  0.215  0.242
cvpred       0.432  0.275  0.116  0.0467  0.165  0.0430  0.173  0.141  0.415  0.104 0.274  0.0525 -0.091  0.0379  0.194  0.207  0.262
Donated      0.000  0.000  0.000  0.0000  0.000  0.0000  0.000  0.000  0.000  0.000 1.000  0.0000  0.000  0.0000  0.000  0.000  0.000
CV residual -0.432 -0.275 -0.116 -0.0467 -0.165 -0.0430 -0.173 -0.141 -0.415 -0.104 0.726 -0.0525  0.091 -0.0379 -0.194 -0.207 -0.262
               252     455    357    104   179     93     428   524    327    328    599    229    664   145    57    315    157   518
Predicted    0.185  0.0557  0.164  0.308 0.269  0.284  0.0562 0.386  0.191  0.248  0.266  0.260  0.161 0.269 0.362  0.200  0.284 0.747
cvpred       0.224  0.0525  0.162  0.311 0.279  0.278  0.0874 0.386  0.217  0.260  0.274  0.257  0.183 0.267 0.352  0.197  0.281 0.706
Donated      0.000  0.0000  0.000  0.000 1.000  0.000  0.0000 1.000  0.000  0.000  0.000  0.000  0.000 1.000 1.000  0.000  0.000 1.000
CV residual -0.224 -0.0525 -0.162 -0.311 0.721 -0.278 -0.0874 0.614 -0.217 -0.260 -0.274 -0.257 -0.183 0.733 0.648 -0.197 -0.281 0.294
              319    45     710     14    567    135    265   339    388     711    620     726     421   253     2     714    512    248
Predicted   0.185 0.521  0.0950  0.446  0.287  0.266  0.194 0.176  0.140  0.0557  0.260  0.0557  0.0737 0.254 0.512  0.0413  0.452  0.251
cvpred      0.203 0.503  0.0957  0.438  0.292  0.298  0.221 0.173  0.137  0.0488  0.257  0.0525  0.0686 0.250 0.489  0.0728  0.433  0.273
Donated     1.000 1.000  0.0000  0.000  0.000  0.000  0.000 1.000  0.000  0.0000  0.000  0.0000  0.0000 1.000 1.000  0.0000  0.000  0.000
CV residual 0.797 0.497 -0.0957 -0.438 -0.292 -0.298 -0.221 0.827 -0.137 -0.0488 -0.257 -0.0525 -0.0686 0.750 0.511 -0.0728 -0.433 -0.273
               156     727   541    199    508    564     720   322   329   517    406    468    689    600    310    667
Predicted    0.284  0.0530 0.326  0.266  0.461  0.320  0.0621 0.170 0.170 0.341  0.107  0.035  0.131  0.323  0.155  0.176
cvpred       0.281  0.0519 0.327  0.256  0.440  0.318  0.0709 0.187 0.168 0.331  0.119  0.046  0.136  0.306  0.147  0.173
Donated      0.000  0.0000 1.000  0.000  0.000  0.000  0.0000 1.000 1.000 1.000  0.000  0.000  0.000  0.000  0.000  0.000
CV residual -0.281 -0.0519 0.673 -0.256 -0.440 -0.318 -0.0709 0.813 0.832 0.669 -0.119 -0.046 -0.136 -0.306 -0.147 -0.173

Sum of squares = 15.7    Mean square = 0.15    n = 105 

fold 3 
Observations in test set: 105 
                86      1    354    169    558    680   222     50    648     396    258    632    375    368    367    294   101    657
Predicted    0.326  1.173  0.170  0.284  0.302  0.146 0.260  0.308  0.215  0.1134  0.242  0.248  0.134  0.140  0.266  0.200 0.338  0.203
cvpred       0.339  1.232  0.178  0.302  0.314  0.152 0.276  0.327  0.218  0.0997  0.251  0.257  0.136  0.143  0.279  0.207 0.352  0.207
Donated      0.000  1.000  0.000  0.000  0.000  0.000 1.000  0.000  0.000  0.0000  0.000  0.000  0.000  0.000  0.000  0.000 1.000  0.000
CV residual -0.339 -0.232 -0.178 -0.302 -0.314 -0.152 0.724 -0.327 -0.218 -0.0997 -0.251 -0.257 -0.136 -0.143 -0.279 -0.207 0.648 -0.207
               245    134    193    617    748     460   120     429    353     405     501    182     391     440   164    598    349
Predicted    0.218  0.287  0.257  0.260 -0.556  0.0557 0.293  0.0648  0.155  0.0861  1.0405  0.242  0.1071  0.0294 0.284  0.263  0.176
cvpred       0.232  0.296  0.263  0.276 -0.584  0.0612 0.289  0.0701  0.154  0.0767  1.0934  0.257  0.0993  0.0084 0.302  0.268  0.188
Donated      0.000  0.000  0.000  0.000  0.000  0.0000 1.000  0.0000  0.000  0.0000  1.0000  0.000  0.0000  0.0000 1.000  0.000  0.000
CV residual -0.232 -0.296 -0.263 -0.276  0.584 -0.0612 0.711 -0.0701 -0.154 -0.0767 -0.0934 -0.257 -0.0993 -0.0084 0.698 -0.268 -0.188
              385    159    211    610    64   544     35    592   324    674     94   619     729    215    201     30   386    585
Predicted    0.14  0.284  0.260  0.260 0.320 0.284  0.458  0.335 0.200  0.227  0.284 0.260  0.0557  0.260  0.236  0.377  0.11  0.284
cvpred       0.15  0.302  0.276  0.276 0.338 0.302  0.471  0.351 0.204  0.225  0.302 0.276  0.0612  0.276  0.236  0.398  0.10  0.302
Donated      0.00  0.000  0.000  0.000 1.000 1.000  0.000  0.000 1.000  0.000  0.000 1.000  0.0000  0.000  0.000  0.000  0.00  0.000
CV residual -0.15 -0.302 -0.276 -0.276 0.662 0.698 -0.471 -0.351 0.796 -0.225 -0.302 0.724 -0.0612 -0.276 -0.236 -0.398 -0.10 -0.302
               570    403    250     425    242    534   520   197     69    140    163     484    137   563     746    118    213   692
Predicted    0.275  0.131  0.200  0.0831  0.419  0.320 0.404 0.281  0.341  0.281  0.284  0.0317  0.275 0.339 -0.0369  0.329  0.260  0.14
cvpred       0.279  0.136  0.214  0.0755  0.425  0.337 0.425 0.292  0.358  0.296  0.302  0.0359  0.282 0.333 -0.0501  0.334  0.276  0.15
Donated      0.000  0.000  0.000  0.0000  0.000  0.000 1.000 1.000  0.000  0.000  0.000  0.0000  0.000 1.000  0.0000  0.000  0.000  0.00
CV residual -0.279 -0.136 -0.214 -0.0755 -0.425 -0.337 0.575 0.708 -0.358 -0.296 -0.302 -0.0359 -0.282 0.667  0.0501 -0.334 -0.276 -0.15
              543    153    358    160     54    116     42    260     448    16    535    618   102    407     12     459    369     89
Predicted   0.422  0.278  0.152  0.284  0.398  0.569  0.338  0.290  0.0467 0.353  0.332  0.260 0.350  0.116  0.344  0.0557  0.155  0.284
cvpred      0.432  0.274  0.159  0.302  0.410  0.597  0.356  0.298  0.0512 0.373  0.346  0.276 0.351  0.124  0.365  0.0612  0.161  0.302
Donated     1.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.0000 1.000  0.000  0.000 1.000  0.000  0.000  0.0000  0.000  0.000
CV residual 0.568 -0.274 -0.159 -0.302 -0.410 -0.597 -0.356 -0.298 -0.0512 0.627 -0.346 -0.276 0.649 -0.124 -0.365 -0.0612 -0.161 -0.302
               616   511    309    41    699     478    338     363     457   216   264     734   190   306     716     48
Predicted    0.260 0.332  0.167 0.419  0.116  0.0317  0.161  0.1073  0.0557 0.260 0.224  0.0317 0.263 0.194  0.0472  0.308
cvpred       0.276 0.354  0.177 0.432  0.110  0.0359  0.156  0.0912  0.0612 0.276 0.226  0.0359 0.270 0.199  0.0337  0.327
Donated      0.000 1.000  0.000 1.000  0.000  0.0000  0.000  0.0000  0.0000 1.000 1.000  0.0000 1.000 1.000  0.0000  0.000
CV residual -0.276 0.646 -0.177 0.568 -0.110 -0.0359 -0.156 -0.0912 -0.0612 0.724 0.774 -0.0359 0.730 0.801 -0.0337 -0.327

Sum of squares = 15.1    Mean square = 0.14    n = 105 

fold 4 
Observations in test set: 105 
               557    43    109    148    218    271    174    259    416    340    195    180    346     470    326    653    208    635
Predicted    0.299 0.338  0.296  0.281  0.260  0.284  0.284  0.236  0.116  0.173  0.272  0.272  0.176  0.0232  0.158  0.176  0.206  0.191
cvpred       0.290 0.331  0.292  0.279  0.264  0.275  0.286  0.230  0.127  0.170  0.269  0.266  0.184  0.0120  0.166  0.178  0.179  0.197
Donated      0.000 1.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.0000  0.000  0.000  0.000  0.000
CV residual -0.290 0.669 -0.292 -0.279 -0.264 -0.275 -0.286 -0.230 -0.127 -0.170 -0.269 -0.266 -0.184 -0.0120 -0.166 -0.178 -0.179 -0.197
               659    37    267     491   523    578   151    176   376   662    55    314    574    236     26   505    350    650
Predicted    0.179 0.413  0.236 -0.0218 0.443  0.305 0.260  0.320 0.137  0.14 0.326  0.200  0.281  0.263  0.464 0.680  0.176  0.212
cvpred       0.180 0.388  0.232 -0.0285 0.421  0.293 0.238  0.309 0.134  0.15 0.321  0.207  0.279  0.241  0.440 0.627  0.184  0.203
Donated      0.000 1.000  0.000  0.0000 1.000  0.000 1.000  0.000 1.000  0.00 1.000  0.000  0.000  0.000  0.000 1.000  0.000  0.000
CV residual -0.180 0.612 -0.232  0.0285 0.579 -0.293 0.762 -0.309 0.866 -0.15 0.679 -0.207 -0.279 -0.241 -0.440 0.373 -0.184 -0.203
                737     427   127    747   561    397    194    257    612    364     59    589   519     480    419     461    198    525
Predicted    0.0317  0.0557 0.302 -0.160 0.320 0.0797  0.323  0.248  0.260  0.236  0.407  0.284 0.398  0.0317  0.116  0.0557  0.251  0.380
cvpred       0.0470  0.0698 0.284 -0.135 0.293 0.0925  0.309  0.246  0.264  0.224  0.367  0.286 0.381  0.0470  0.127  0.0698  0.235  0.366
Donated      0.0000  0.0000 1.000  0.000 1.000 1.0000  0.000  0.000  0.000  0.000  0.000  0.000 1.000  0.0000  0.000  0.0000  0.000  0.000
CV residual -0.0470 -0.0698 0.716  0.135 0.707 0.9075 -0.309 -0.246 -0.264 -0.224 -0.367 -0.286 0.619 -0.0470 -0.127 -0.0698 -0.235 -0.366
               631   336    311    62    20    73     717     374     431    230    348    278     721    115     730   640    263    611
Predicted    0.236 0.149  0.191 0.353 0.326 0.443  0.0648  0.1042  0.0951  0.260  0.176  0.218  0.0529  0.308  0.0319 0.170  0.245  0.260
cvpred       0.215 0.156  0.186 0.337 0.325 0.406  0.0761  0.0902  0.0875  0.264  0.184  0.210  0.0593  0.273  0.0398 0.141  0.240  0.264
Donated      0.000 1.000  0.000 1.000 1.000 1.000  0.0000  0.0000  0.0000  0.000  0.000  0.000  0.0000  0.000  0.0000 1.000  0.000  0.000
CV residual -0.215 0.844 -0.186 0.663 0.675 0.594 -0.0761 -0.0902 -0.0875 -0.264 -0.184 -0.210 -0.0593 -0.273 -0.0398 0.859 -0.240 -0.264
               274    17     7    220    29    377    571   383    579   713    638   552     51   538    603   537     27    280    85
Predicted    0.194 0.458 0.392  0.260 0.335  0.128  0.269  0.14  0.251 0.101  0.221 0.305  0.392 0.332  0.233 0.338  0.350  0.233 0.326
cvpred       0.176 0.430 0.383  0.264 0.331  0.122  0.252  0.15  0.252 0.103  0.217 0.291  0.369 0.321  0.236 0.324  0.344  0.221 0.314
Donated      0.000 1.000 1.000  0.000 1.000  0.000  0.000  0.00  0.000 1.000  0.000 1.000  0.000 1.000  0.000 1.000  0.000  0.000 1.000
CV residual -0.176 0.570 0.617 -0.264 0.669 -0.122 -0.252 -0.15 -0.252 0.897 -0.217 0.709 -0.369 0.679 -0.236 0.676 -0.344 -0.221 0.686
               269     735    568   244    77    173    435   550     442    590    652    277    496    347
Predicted    0.170  0.0317  0.299 0.356 0.314  0.284  0.101 0.320  0.0293  0.284  0.179  0.299 -0.151  0.176
cvpred       0.143  0.0470  0.277 0.323 0.308  0.286  0.103 0.308  0.0150  0.286  0.181  0.281 -0.140  0.184
Donated      0.000  0.0000  0.000 1.000 1.000  0.000  0.000 1.000  0.0000  0.000  0.000  0.000  0.000  0.000
CV residual -0.143 -0.0470 -0.277 0.677 0.692 -0.286 -0.103 0.692 -0.0150 -0.286 -0.181 -0.281  0.140 -0.184

Sum of squares = 17.2    Mean square = 0.16    n = 105 

fold 5 
Observations in test set: 104 
               379    24    107    332    604    318     80     712    629    209     9   288     95    649    18    299   282    691
Predicted    0.140 0.362  0.299  0.179  0.272  0.176  0.302  0.0859  0.197  0.248 0.416 0.203  0.371  0.188 0.479  0.164 0.188  0.140
cvpred       0.118 0.365  0.307  0.167  0.267  0.161  0.295  0.0666  0.195  0.241 0.426 0.188  0.376  0.174 0.503  0.145 0.173  0.118
Donated      0.000 1.000  0.000  0.000  0.000  0.000  0.000  0.0000  0.000  0.000 1.000 1.000  0.000  0.000 1.000  0.000 1.000  0.000
CV residual -0.118 0.635 -0.307 -0.167 -0.267 -0.161 -0.295 -0.0666 -0.195 -0.241 0.574 0.812 -0.376 -0.174 0.497 -0.145 0.827 -0.118
               675    685    656    601    273     401   266     3     718    325     25   531    200    231    663   530    588     715
Predicted    0.194  0.137  0.293  0.272  0.221  0.1007 0.215 0.554  0.0618  0.194  0.371 0.320  0.284  0.260  0.149 0.344  0.284  0.0621
cvpred       0.191  0.120  0.305  0.264  0.208  0.0772 0.209 0.583  0.0373  0.184  0.374 0.318  0.286  0.248  0.130 0.346  0.274  0.0438
Donated      0.000  0.000  0.000  0.000  0.000  0.0000 1.000 1.000  0.0000  0.000  0.000 1.000  0.000  0.000  0.000 1.000  0.000  0.0000
CV residual -0.191 -0.120 -0.305 -0.264 -0.208 -0.0772 0.791 0.417 -0.0373 -0.184 -0.374 0.682 -0.286 -0.248 -0.130 0.654 -0.274 -0.0438
               76     462    192   681    500    317   177    621    666    224    542    497    185    583    142   334     96    308
Predicted   0.302  0.0557  0.260 0.233 -0.580  0.182 0.233  0.230  0.176  0.260  0.350 -0.148  0.281  0.284  0.317 0.167  0.332  0.188
cvpred      0.295  0.0267  0.262 0.236 -0.664  0.165 0.222  0.231  0.157  0.248  0.361 -0.195  0.277  0.274  0.334 0.161  0.335  0.174
Donated     1.000  0.0000  0.000 1.000  0.000  0.000 1.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000 1.000  0.000  0.000
CV residual 0.705 -0.0267 -0.262 0.764  0.664 -0.165 0.778 -0.231 -0.157 -0.248 -0.361  0.195 -0.277 -0.274 -0.334 0.839 -0.335 -0.174
                705   510     424   576     399     719    303       483   504   553     66    144   575     394   522     402      733
Predicted    0.1157 0.482  0.0737 0.278  0.1042  0.0618  0.164  0.031721  1.03 0.308  0.419  0.272 0.281  0.0981 0.407  0.0978 0.031721
cvpred       0.0919 0.502  0.0472 0.278  0.0953  0.0373  0.145  0.000671  1.12 0.308  0.444  0.265 0.274  0.0846 0.421  0.0765 0.000671
Donated      0.0000 1.000  0.0000 1.000  0.0000  0.0000  0.000  0.000000  0.00 1.000  0.000  0.000 1.000  0.0000 1.000  0.0000 1.000000
CV residual -0.0919 0.498 -0.0472 0.722 -0.0953 -0.0373 -0.145 -0.000671 -1.12 0.692 -0.444 -0.265 0.726 -0.0846 0.579 -0.0765 0.999329
               633    132      6       741    65    287   295     395    695    150    608     410   641     63     61     417   196
Predicted    0.224  0.270  0.332  0.031721 0.311  0.227  0.20  0.1159  0.140  0.281  0.203  0.1157 0.221  0.359  0.347  0.1157 0.245
cvpred       0.215  0.284  0.328  0.000671 0.306  0.217  0.19  0.0986  0.118  0.274  0.206  0.0919 0.218  0.371  0.352  0.0919 0.244
Donated      0.000  0.000  0.000  0.000000 1.000  0.000  0.00  0.0000  0.000  0.000  0.000  0.0000 1.000  0.000  0.000  0.0000 1.000
CV residual -0.215 -0.284 -0.328 -0.000671 0.694 -0.217 -0.19 -0.0986 -0.118 -0.274 -0.206 -0.0919 0.782 -0.371 -0.352 -0.0919 0.756
               548    39    514       479     78   165    566     426    272   696    654     53       485    647    298   366
Predicted    0.305 0.431  0.488  0.031721  0.302 0.284  0.257  0.0801  0.224 0.125  0.206  0.344  0.031721  0.164  0.164 0.143
cvpred       0.300 0.452  0.509  0.000671  0.295 0.274  0.265  0.0643  0.215 0.114  0.196  0.346  0.000671  0.145  0.145 0.123
Donated      0.000 1.000  0.000  0.000000  0.000 1.000  0.000  0.0000  0.000 1.000  0.000  0.000  0.000000  0.000  0.000 1.000
CV residual -0.300 0.548 -0.509 -0.000671 -0.295 0.726 -0.265 -0.0643 -0.215 0.886 -0.196 -0.346 -0.000671 -0.145 -0.145 0.877

Sum of squares = 19.2    Mean square = 0.18    n = 104 

Overall (Sum over all 104 folds) 
   ms 
0.156 
Warning message:
In cv.lm(data = prtrain, perceptron, m = 5) : 

 As there is >1 explanatory variable, cross-validation
 predicted values for a fold are not a linear function
 of corresponding overall predicted values.  Lines that
 are shown for the different folds are approximate

> perceptron

Call:
lm(formula = Donated ~ ., data = prtrain)

Coefficients:
      (Intercept)   Recency..Months.  Frequency..times.      Time..months.  
           0.2278            -0.0729             0.1402            -0.0729  

> predicted_perceptron= ifelse(predict(perceptron,prtest)>0.5,1,0)
> confusionMatrix(predicted_perceptron,prtest$Donated)
Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 163  54
         1   4   4
                                       
               Accuracy : 0.742        
                 95% CI : (0.68, 0.798)
    No Information Rate : 0.742        
    P-Value [Acc > NIR] : 0.535        
                                       
                  Kappa : 0.063        
 Mcnemar's Test P-Value : 1.24e-10     
                                       
            Sensitivity : 0.976        
            Specificity : 0.069        
         Pos Pred Value : 0.751        
         Neg Pred Value : 0.500        
             Prevalence : 0.742        
         Detection Rate : 0.724        
   Detection Prevalence : 0.964        
      Balanced Accuracy : 0.523        
                                       
       'Positive' Class : 0            
                                       
> ROCp<-roc(prtest$Donated,predicted_perceptron)
> plot(ROCp)
> aucp<-auc(ROCp)
> aucp
Area under the curve: 0.523
> plot(ROCp)
>

> 
> perceptron <-lm(Donated~ ., data=prtrain)
> cv.lm(data=prtrain, perceptron, m=5)
Analysis of Variance Table

Response: Donated
                   Df Sum Sq Mean Sq F value  Pr(>F)    
Recency..Months.    1    7.2    7.16   46.28 2.8e-11 ***
Frequency..times.   1    3.6    3.63   23.42 1.7e-06 ***
Time..months.       1    1.3    1.34    8.67  0.0034 ** 
Residuals         519   80.3    0.15                    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1



fold 1 
Observations in test set: 104 
                430      742    68    320     467    235   587    547     728    313    341    701     739    52    411    337     494
Predicted    0.0919 -0.01868  0.32  0.182  0.0379  0.248 0.284  0.413  0.0557  0.212  0.164  0.107  0.0317 0.392  0.116  0.173 -0.1177
cvpred       0.1005  0.00406  0.31  0.188  0.0535  0.255 0.275  0.422  0.0649  0.223  0.170  0.115  0.0428 0.394  0.120  0.176 -0.0972
Donated      0.0000  0.00000  0.00  0.000  0.0000  0.000 1.000  0.000  0.0000  0.000  0.000  0.000  0.0000 1.000  0.000  0.000  0.0000
CV residual -0.1005 -0.00406 -0.31 -0.188 -0.0535 -0.255 0.725 -0.422 -0.0649 -0.223 -0.170 -0.115 -0.0428 0.606 -0.120 -0.176  0.0972
              178    554   539    110     465    697      8     708    171    255   154   181    131    562     88     438     31    390
Predicted   0.269  0.296 0.344  0.314  0.0557  0.125  0.458  0.0593  0.284  0.311 0.284 0.266  0.284  0.308  0.284  0.0740  0.437  0.107
cvpred      0.268  0.289 0.344  0.318  0.0649  0.131  0.459  0.0685  0.275  0.325 0.275 0.263  0.282  0.312  0.277  0.0824  0.442  0.121
Donated     1.000  0.000 1.000  0.000  0.0000  0.000  0.000  0.0000  0.000  0.000 1.000 1.000  0.000  0.000  0.000  0.0000  0.000  0.000
CV residual 0.732 -0.289 0.656 -0.318 -0.0649 -0.131 -0.459 -0.0685 -0.275 -0.325 0.725 0.737 -0.282 -0.312 -0.277 -0.0824 -0.442 -0.121
                79   515   521    152    409    90    560    646    660    205    214     83     84   46    202    240    439     472
Predicted    0.302 0.518 0.410  0.275  0.116 0.329  0.299  0.164  0.191  0.287  0.260  0.314  0.314 0.38  0.242  0.254  0.134  0.0289
cvpred       0.293 0.524 0.412  0.275  0.120 0.328  0.301  0.167  0.201  0.295  0.253  0.308  0.308 0.38  0.245  0.262  0.162  0.0433
Donated      0.000 1.000 1.000  0.000  0.000 1.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000 1.00  0.000  0.000  0.000  0.0000
CV residual -0.293 0.476 0.588 -0.275 -0.120 0.672 -0.301 -0.167 -0.201 -0.295 -0.253 -0.308 -0.308 0.62 -0.245 -0.262 -0.162 -0.0433
               677    21   243     22    551    286   130   290    420      487    184    175   623    103    128     740    219   262
Predicted    0.152 0.326 0.245  0.428  0.296  0.191 0.284 0.173  0.110 -0.01869  0.272  0.284 0.242  0.344  0.284  0.0170  0.260 0.302
cvpred       0.157 0.318 0.242  0.430  0.292  0.191 0.276 0.177  0.116  0.00154  0.282  0.275 0.240  0.346  0.280  0.0335  0.253 0.317
Donated      0.000 1.000 1.000  0.000  0.000  0.000 1.000 1.000  0.000  0.00000  0.000  0.000 1.000  0.000  0.000  0.0000  0.000 1.000
CV residual -0.157 0.682 0.758 -0.430 -0.292 -0.191 0.724 0.823 -0.116 -0.00154 -0.282 -0.275 0.760 -0.346 -0.280 -0.0335 -0.253 0.683
               233   569     493    381     744     449    634   709      488    651    418    343    506     466     738    141    246
Predicted    0.260 0.287 -0.0877  0.140  0.0109  0.0771  0.323 0.119  0.00495  0.200  0.116  0.155 0.9566  0.0351  0.0317  0.260  0.230
cvpred       0.253 0.287 -0.0669  0.142  0.0244  0.0974  0.339 0.122  0.02032  0.197  0.120  0.164 0.9833  0.0515  0.0428  0.265  0.231
Donated      0.000 1.000  0.0000  0.000  0.0000  0.0000  0.000 1.000  0.00000  0.000  0.000  0.000 1.0000  0.0000  0.0000  0.000  0.000
CV residual -0.253 0.713  0.0669 -0.142 -0.0244 -0.0974 -0.339 0.878 -0.02032 -0.197 -0.120 -0.164 0.0167 -0.0515 -0.0428 -0.265 -0.231
               414    335      490       745    533    513    221    665     477    293    228     437     47   527    207    75
Predicted    0.101  0.140 -0.02489 -0.013003  0.356  0.446  0.260  0.176  0.0112  0.197  0.248  0.0678  0.374 0.338  0.266 0.302
cvpred       0.111  0.145 -0.00919  0.000607  0.356  0.446  0.253  0.175  0.0311  0.200  0.244  0.0780  0.374 0.333  0.259 0.293
Donated      0.000  0.000  0.00000  0.000000  0.000  0.000  0.000  0.000  0.0000  0.000  0.000  0.0000  0.000 1.000  0.000 1.000
CV residual -0.111 -0.145  0.00919 -0.000607 -0.356 -0.446 -0.253 -0.175 -0.0311 -0.200 -0.244 -0.0780 -0.374 0.667 -0.259 0.707

Sum of squares = 14.2    Mean square = 0.14    n = 104 

fold 2 
Observations in test set: 105 
               212    133    40   289     398    58    239   370    125   613    393    643   509    172    234    698    382     70
Predicted    0.260  0.284 0.350 0.194  0.0888 0.350  0.233 0.140  0.284 0.260  0.119  0.206 0.614  0.284  0.269  0.125  0.140  0.338
cvpred       0.257  0.284 0.341 0.188  0.0824 0.347  0.253 0.142  0.290 0.257  0.157  0.210 0.581  0.281  0.265  0.132  0.137  0.348
Donated      0.000  0.000 1.000 1.000  0.0000 1.000  0.000 1.000  0.000 1.000  0.000  0.000 1.000  0.000  0.000  0.000  0.000  0.000
CV residual -0.257 -0.284 0.659 0.812 -0.0824 0.653 -0.253 0.858 -0.290 0.743 -0.157 -0.210 0.419 -0.281 -0.265 -0.132 -0.137 -0.348
               249   117    183    155     4     92    189    361    565    188    238    378    351    91    628    126    119    323
Predicted    0.200 0.296  0.257  0.284 0.611  0.284  0.341  0.149  0.326  0.266  0.254  0.140  0.176 0.284  0.200  0.284  0.272  0.179
cvpred       0.193 0.308  0.271  0.281 0.576  0.278  0.344  0.158  0.344  0.270  0.256  0.137  0.173 0.278  0.193  0.293  0.294  0.184
Donated      0.000 1.000  0.000  0.000 1.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000 1.000  0.000  0.000  0.000  0.000
CV residual -0.193 0.692 -0.271 -0.281 0.424 -0.278 -0.344 -0.158 -0.344 -0.270 -0.256 -0.137 -0.173 0.722 -0.193 -0.293 -0.294 -0.184
               528    191    445     731    362     722    344    372     97    443   577     464    495     453    296    210    204
Predicted    0.434  0.260  0.107  0.0438  0.161  0.0438  0.176  0.137  0.407  0.077 0.266  0.0557 -0.136  0.0408  0.152  0.215  0.242
cvpred       0.432  0.275  0.116  0.0467  0.165  0.0430  0.173  0.141  0.415  0.104 0.274  0.0525 -0.091  0.0379  0.194  0.207  0.262
Donated      0.000  0.000  0.000  0.0000  0.000  0.0000  0.000  0.000  0.000  0.000 1.000  0.0000  0.000  0.0000  0.000  0.000  0.000
CV residual -0.432 -0.275 -0.116 -0.0467 -0.165 -0.0430 -0.173 -0.141 -0.415 -0.104 0.726 -0.0525  0.091 -0.0379 -0.194 -0.207 -0.262
               252     455    357    104   179     93     428   524    327    328    599    229    664   145    57    315    157   518
Predicted    0.185  0.0557  0.164  0.308 0.269  0.284  0.0562 0.386  0.191  0.248  0.266  0.260  0.161 0.269 0.362  0.200  0.284 0.747
cvpred       0.224  0.0525  0.162  0.311 0.279  0.278  0.0874 0.386  0.217  0.260  0.274  0.257  0.183 0.267 0.352  0.197  0.281 0.706
Donated      0.000  0.0000  0.000  0.000 1.000  0.000  0.0000 1.000  0.000  0.000  0.000  0.000  0.000 1.000 1.000  0.000  0.000 1.000
CV residual -0.224 -0.0525 -0.162 -0.311 0.721 -0.278 -0.0874 0.614 -0.217 -0.260 -0.274 -0.257 -0.183 0.733 0.648 -0.197 -0.281 0.294
              319    45     710     14    567    135    265   339    388     711    620     726     421   253     2     714    512    248
Predicted   0.185 0.521  0.0950  0.446  0.287  0.266  0.194 0.176  0.140  0.0557  0.260  0.0557  0.0737 0.254 0.512  0.0413  0.452  0.251
cvpred      0.203 0.503  0.0957  0.438  0.292  0.298  0.221 0.173  0.137  0.0488  0.257  0.0525  0.0686 0.250 0.489  0.0728  0.433  0.273
Donated     1.000 1.000  0.0000  0.000  0.000  0.000  0.000 1.000  0.000  0.0000  0.000  0.0000  0.0000 1.000 1.000  0.0000  0.000  0.000
CV residual 0.797 0.497 -0.0957 -0.438 -0.292 -0.298 -0.221 0.827 -0.137 -0.0488 -0.257 -0.0525 -0.0686 0.750 0.511 -0.0728 -0.433 -0.273
               156     727   541    199    508    564     720   322   329   517    406    468    689    600    310    667
Predicted    0.284  0.0530 0.326  0.266  0.461  0.320  0.0621 0.170 0.170 0.341  0.107  0.035  0.131  0.323  0.155  0.176
cvpred       0.281  0.0519 0.327  0.256  0.440  0.318  0.0709 0.187 0.168 0.331  0.119  0.046  0.136  0.306  0.147  0.173
Donated      0.000  0.0000 1.000  0.000  0.000  0.000  0.0000 1.000 1.000 1.000  0.000  0.000  0.000  0.000  0.000  0.000
CV residual -0.281 -0.0519 0.673 -0.256 -0.440 -0.318 -0.0709 0.813 0.832 0.669 -0.119 -0.046 -0.136 -0.306 -0.147 -0.173

Sum of squares = 15.7    Mean square = 0.15    n = 105 

fold 3 
Observations in test set: 105 
                86      1    354    169    558    680   222     50    648     396    258    632    375    368    367    294   101    657
Predicted    0.326  1.173  0.170  0.284  0.302  0.146 0.260  0.308  0.215  0.1134  0.242  0.248  0.134  0.140  0.266  0.200 0.338  0.203
cvpred       0.339  1.232  0.178  0.302  0.314  0.152 0.276  0.327  0.218  0.0997  0.251  0.257  0.136  0.143  0.279  0.207 0.352  0.207
Donated      0.000  1.000  0.000  0.000  0.000  0.000 1.000  0.000  0.000  0.0000  0.000  0.000  0.000  0.000  0.000  0.000 1.000  0.000
CV residual -0.339 -0.232 -0.178 -0.302 -0.314 -0.152 0.724 -0.327 -0.218 -0.0997 -0.251 -0.257 -0.136 -0.143 -0.279 -0.207 0.648 -0.207
               245    134    193    617    748     460   120     429    353     405     501    182     391     440   164    598    349
Predicted    0.218  0.287  0.257  0.260 -0.556  0.0557 0.293  0.0648  0.155  0.0861  1.0405  0.242  0.1071  0.0294 0.284  0.263  0.176
cvpred       0.232  0.296  0.263  0.276 -0.584  0.0612 0.289  0.0701  0.154  0.0767  1.0934  0.257  0.0993  0.0084 0.302  0.268  0.188
Donated      0.000  0.000  0.000  0.000  0.000  0.0000 1.000  0.0000  0.000  0.0000  1.0000  0.000  0.0000  0.0000 1.000  0.000  0.000
CV residual -0.232 -0.296 -0.263 -0.276  0.584 -0.0612 0.711 -0.0701 -0.154 -0.0767 -0.0934 -0.257 -0.0993 -0.0084 0.698 -0.268 -0.188
              385    159    211    610    64   544     35    592   324    674     94   619     729    215    201     30   386    585
Predicted    0.14  0.284  0.260  0.260 0.320 0.284  0.458  0.335 0.200  0.227  0.284 0.260  0.0557  0.260  0.236  0.377  0.11  0.284
cvpred       0.15  0.302  0.276  0.276 0.338 0.302  0.471  0.351 0.204  0.225  0.302 0.276  0.0612  0.276  0.236  0.398  0.10  0.302
Donated      0.00  0.000  0.000  0.000 1.000 1.000  0.000  0.000 1.000  0.000  0.000 1.000  0.0000  0.000  0.000  0.000  0.00  0.000
CV residual -0.15 -0.302 -0.276 -0.276 0.662 0.698 -0.471 -0.351 0.796 -0.225 -0.302 0.724 -0.0612 -0.276 -0.236 -0.398 -0.10 -0.302
               570    403    250     425    242    534   520   197     69    140    163     484    137   563     746    118    213   692
Predicted    0.275  0.131  0.200  0.0831  0.419  0.320 0.404 0.281  0.341  0.281  0.284  0.0317  0.275 0.339 -0.0369  0.329  0.260  0.14
cvpred       0.279  0.136  0.214  0.0755  0.425  0.337 0.425 0.292  0.358  0.296  0.302  0.0359  0.282 0.333 -0.0501  0.334  0.276  0.15
Donated      0.000  0.000  0.000  0.0000  0.000  0.000 1.000 1.000  0.000  0.000  0.000  0.0000  0.000 1.000  0.0000  0.000  0.000  0.00
CV residual -0.279 -0.136 -0.214 -0.0755 -0.425 -0.337 0.575 0.708 -0.358 -0.296 -0.302 -0.0359 -0.282 0.667  0.0501 -0.334 -0.276 -0.15
              543    153    358    160     54    116     42    260     448    16    535    618   102    407     12     459    369     89
Predicted   0.422  0.278  0.152  0.284  0.398  0.569  0.338  0.290  0.0467 0.353  0.332  0.260 0.350  0.116  0.344  0.0557  0.155  0.284
cvpred      0.432  0.274  0.159  0.302  0.410  0.597  0.356  0.298  0.0512 0.373  0.346  0.276 0.351  0.124  0.365  0.0612  0.161  0.302
Donated     1.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.0000 1.000  0.000  0.000 1.000  0.000  0.000  0.0000  0.000  0.000
CV residual 0.568 -0.274 -0.159 -0.302 -0.410 -0.597 -0.356 -0.298 -0.0512 0.627 -0.346 -0.276 0.649 -0.124 -0.365 -0.0612 -0.161 -0.302
               616   511    309    41    699     478    338     363     457   216   264     734   190   306     716     48
Predicted    0.260 0.332  0.167 0.419  0.116  0.0317  0.161  0.1073  0.0557 0.260 0.224  0.0317 0.263 0.194  0.0472  0.308
cvpred       0.276 0.354  0.177 0.432  0.110  0.0359  0.156  0.0912  0.0612 0.276 0.226  0.0359 0.270 0.199  0.0337  0.327
Donated      0.000 1.000  0.000 1.000  0.000  0.0000  0.000  0.0000  0.0000 1.000 1.000  0.0000 1.000 1.000  0.0000  0.000
CV residual -0.276 0.646 -0.177 0.568 -0.110 -0.0359 -0.156 -0.0912 -0.0612 0.724 0.774 -0.0359 0.730 0.801 -0.0337 -0.327

Sum of squares = 15.1    Mean square = 0.14    n = 105 

fold 4 
Observations in test set: 105 
               557    43    109    148    218    271    174    259    416    340    195    180    346     470    326    653    208    635
Predicted    0.299 0.338  0.296  0.281  0.260  0.284  0.284  0.236  0.116  0.173  0.272  0.272  0.176  0.0232  0.158  0.176  0.206  0.191
cvpred       0.290 0.331  0.292  0.279  0.264  0.275  0.286  0.230  0.127  0.170  0.269  0.266  0.184  0.0120  0.166  0.178  0.179  0.197
Donated      0.000 1.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.0000  0.000  0.000  0.000  0.000
CV residual -0.290 0.669 -0.292 -0.279 -0.264 -0.275 -0.286 -0.230 -0.127 -0.170 -0.269 -0.266 -0.184 -0.0120 -0.166 -0.178 -0.179 -0.197
               659    37    267     491   523    578   151    176   376   662    55    314    574    236     26   505    350    650
Predicted    0.179 0.413  0.236 -0.0218 0.443  0.305 0.260  0.320 0.137  0.14 0.326  0.200  0.281  0.263  0.464 0.680  0.176  0.212
cvpred       0.180 0.388  0.232 -0.0285 0.421  0.293 0.238  0.309 0.134  0.15 0.321  0.207  0.279  0.241  0.440 0.627  0.184  0.203
Donated      0.000 1.000  0.000  0.0000 1.000  0.000 1.000  0.000 1.000  0.00 1.000  0.000  0.000  0.000  0.000 1.000  0.000  0.000
CV residual -0.180 0.612 -0.232  0.0285 0.579 -0.293 0.762 -0.309 0.866 -0.15 0.679 -0.207 -0.279 -0.241 -0.440 0.373 -0.184 -0.203
                737     427   127    747   561    397    194    257    612    364     59    589   519     480    419     461    198    525
Predicted    0.0317  0.0557 0.302 -0.160 0.320 0.0797  0.323  0.248  0.260  0.236  0.407  0.284 0.398  0.0317  0.116  0.0557  0.251  0.380
cvpred       0.0470  0.0698 0.284 -0.135 0.293 0.0925  0.309  0.246  0.264  0.224  0.367  0.286 0.381  0.0470  0.127  0.0698  0.235  0.366
Donated      0.0000  0.0000 1.000  0.000 1.000 1.0000  0.000  0.000  0.000  0.000  0.000  0.000 1.000  0.0000  0.000  0.0000  0.000  0.000
CV residual -0.0470 -0.0698 0.716  0.135 0.707 0.9075 -0.309 -0.246 -0.264 -0.224 -0.367 -0.286 0.619 -0.0470 -0.127 -0.0698 -0.235 -0.366
               631   336    311    62    20    73     717     374     431    230    348    278     721    115     730   640    263    611
Predicted    0.236 0.149  0.191 0.353 0.326 0.443  0.0648  0.1042  0.0951  0.260  0.176  0.218  0.0529  0.308  0.0319 0.170  0.245  0.260
cvpred       0.215 0.156  0.186 0.337 0.325 0.406  0.0761  0.0902  0.0875  0.264  0.184  0.210  0.0593  0.273  0.0398 0.141  0.240  0.264
Donated      0.000 1.000  0.000 1.000 1.000 1.000  0.0000  0.0000  0.0000  0.000  0.000  0.000  0.0000  0.000  0.0000 1.000  0.000  0.000
CV residual -0.215 0.844 -0.186 0.663 0.675 0.594 -0.0761 -0.0902 -0.0875 -0.264 -0.184 -0.210 -0.0593 -0.273 -0.0398 0.859 -0.240 -0.264
               274    17     7    220    29    377    571   383    579   713    638   552     51   538    603   537     27    280    85
Predicted    0.194 0.458 0.392  0.260 0.335  0.128  0.269  0.14  0.251 0.101  0.221 0.305  0.392 0.332  0.233 0.338  0.350  0.233 0.326
cvpred       0.176 0.430 0.383  0.264 0.331  0.122  0.252  0.15  0.252 0.103  0.217 0.291  0.369 0.321  0.236 0.324  0.344  0.221 0.314
Donated      0.000 1.000 1.000  0.000 1.000  0.000  0.000  0.00  0.000 1.000  0.000 1.000  0.000 1.000  0.000 1.000  0.000  0.000 1.000
CV residual -0.176 0.570 0.617 -0.264 0.669 -0.122 -0.252 -0.15 -0.252 0.897 -0.217 0.709 -0.369 0.679 -0.236 0.676 -0.344 -0.221 0.686
               269     735    568   244    77    173    435   550     442    590    652    277    496    347
Predicted    0.170  0.0317  0.299 0.356 0.314  0.284  0.101 0.320  0.0293  0.284  0.179  0.299 -0.151  0.176
cvpred       0.143  0.0470  0.277 0.323 0.308  0.286  0.103 0.308  0.0150  0.286  0.181  0.281 -0.140  0.184
Donated      0.000  0.0000  0.000 1.000 1.000  0.000  0.000 1.000  0.0000  0.000  0.000  0.000  0.000  0.000
CV residual -0.143 -0.0470 -0.277 0.677 0.692 -0.286 -0.103 0.692 -0.0150 -0.286 -0.181 -0.281  0.140 -0.184

Sum of squares = 17.2    Mean square = 0.16    n = 105 

fold 5 
Observations in test set: 104 
               379    24    107    332    604    318     80     712    629    209     9   288     95    649    18    299   282    691
Predicted    0.140 0.362  0.299  0.179  0.272  0.176  0.302  0.0859  0.197  0.248 0.416 0.203  0.371  0.188 0.479  0.164 0.188  0.140
cvpred       0.118 0.365  0.307  0.167  0.267  0.161  0.295  0.0666  0.195  0.241 0.426 0.188  0.376  0.174 0.503  0.145 0.173  0.118
Donated      0.000 1.000  0.000  0.000  0.000  0.000  0.000  0.0000  0.000  0.000 1.000 1.000  0.000  0.000 1.000  0.000 1.000  0.000
CV residual -0.118 0.635 -0.307 -0.167 -0.267 -0.161 -0.295 -0.0666 -0.195 -0.241 0.574 0.812 -0.376 -0.174 0.497 -0.145 0.827 -0.118
               675    685    656    601    273     401   266     3     718    325     25   531    200    231    663   530    588     715
Predicted    0.194  0.137  0.293  0.272  0.221  0.1007 0.215 0.554  0.0618  0.194  0.371 0.320  0.284  0.260  0.149 0.344  0.284  0.0621
cvpred       0.191  0.120  0.305  0.264  0.208  0.0772 0.209 0.583  0.0373  0.184  0.374 0.318  0.286  0.248  0.130 0.346  0.274  0.0438
Donated      0.000  0.000  0.000  0.000  0.000  0.0000 1.000 1.000  0.0000  0.000  0.000 1.000  0.000  0.000  0.000 1.000  0.000  0.0000
CV residual -0.191 -0.120 -0.305 -0.264 -0.208 -0.0772 0.791 0.417 -0.0373 -0.184 -0.374 0.682 -0.286 -0.248 -0.130 0.654 -0.274 -0.0438
               76     462    192   681    500    317   177    621    666    224    542    497    185    583    142   334     96    308
Predicted   0.302  0.0557  0.260 0.233 -0.580  0.182 0.233  0.230  0.176  0.260  0.350 -0.148  0.281  0.284  0.317 0.167  0.332  0.188
cvpred      0.295  0.0267  0.262 0.236 -0.664  0.165 0.222  0.231  0.157  0.248  0.361 -0.195  0.277  0.274  0.334 0.161  0.335  0.174
Donated     1.000  0.0000  0.000 1.000  0.000  0.000 1.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000 1.000  0.000  0.000
CV residual 0.705 -0.0267 -0.262 0.764  0.664 -0.165 0.778 -0.231 -0.157 -0.248 -0.361  0.195 -0.277 -0.274 -0.334 0.839 -0.335 -0.174
                705   510     424   576     399     719    303       483   504   553     66    144   575     394   522     402      733
Predicted    0.1157 0.482  0.0737 0.278  0.1042  0.0618  0.164  0.031721  1.03 0.308  0.419  0.272 0.281  0.0981 0.407  0.0978 0.031721
cvpred       0.0919 0.502  0.0472 0.278  0.0953  0.0373  0.145  0.000671  1.12 0.308  0.444  0.265 0.274  0.0846 0.421  0.0765 0.000671
Donated      0.0000 1.000  0.0000 1.000  0.0000  0.0000  0.000  0.000000  0.00 1.000  0.000  0.000 1.000  0.0000 1.000  0.0000 1.000000
CV residual -0.0919 0.498 -0.0472 0.722 -0.0953 -0.0373 -0.145 -0.000671 -1.12 0.692 -0.444 -0.265 0.726 -0.0846 0.579 -0.0765 0.999329
               633    132      6       741    65    287   295     395    695    150    608     410   641     63     61     417   196
Predicted    0.224  0.270  0.332  0.031721 0.311  0.227  0.20  0.1159  0.140  0.281  0.203  0.1157 0.221  0.359  0.347  0.1157 0.245
cvpred       0.215  0.284  0.328  0.000671 0.306  0.217  0.19  0.0986  0.118  0.274  0.206  0.0919 0.218  0.371  0.352  0.0919 0.244
Donated      0.000  0.000  0.000  0.000000 1.000  0.000  0.00  0.0000  0.000  0.000  0.000  0.0000 1.000  0.000  0.000  0.0000 1.000
CV residual -0.215 -0.284 -0.328 -0.000671 0.694 -0.217 -0.19 -0.0986 -0.118 -0.274 -0.206 -0.0919 0.782 -0.371 -0.352 -0.0919 0.756
               548    39    514       479     78   165    566     426    272   696    654     53       485    647    298   366
Predicted    0.305 0.431  0.488  0.031721  0.302 0.284  0.257  0.0801  0.224 0.125  0.206  0.344  0.031721  0.164  0.164 0.143
cvpred       0.300 0.452  0.509  0.000671  0.295 0.274  0.265  0.0643  0.215 0.114  0.196  0.346  0.000671  0.145  0.145 0.123
Donated      0.000 1.000  0.000  0.000000  0.000 1.000  0.000  0.0000  0.000 1.000  0.000  0.000  0.000000  0.000  0.000 1.000
CV residual -0.300 0.548 -0.509 -0.000671 -0.295 0.726 -0.265 -0.0643 -0.215 0.886 -0.196 -0.346 -0.000671 -0.145 -0.145 0.877

Sum of squares = 19.2    Mean square = 0.18    n = 104 

Overall (Sum over all 104 folds) 
   ms 
0.156 
Warning message:
In cv.lm(data = prtrain, perceptron, m = 5) : 

 As there is >1 explanatory variable, cross-validation
 predicted values for a fold are not a linear function
 of corresponding overall predicted values.  Lines that
 are shown for the different folds are approximate

> perceptron

Call:
lm(formula = Donated ~ ., data = prtrain)

Coefficients:
	      (Intercept)   Recency..Months.  Frequency..times.      Time..months.  
		   0.2278            -0.0729             0.1402            -0.0729  

> predicted_perceptron= ifelse(predict(perceptron,prtest)>0.35,1,0)
> confusionMatrix(predicted_perceptron,prtest$Donated)
Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 161  44
         1   6  14
                                       
               Accuracy : 0.778        
                 95% CI : (0.718, 0.83)
    No Information Rate : 0.742        
    P-Value [Acc > NIR] : 0.126        
                                       
                  Kappa : 0.261        
 Mcnemar's Test P-Value : 1.67e-07     
                                       
            Sensitivity : 0.964        
            Specificity : 0.241        
         Pos Pred Value : 0.785        
         Neg Pred Value : 0.700        
             Prevalence : 0.742        
         Detection Rate : 0.716        
   Detection Prevalence : 0.911        
      Balanced Accuracy : 0.603        
                                       
       'Positive' Class : 0            
                                       
> ROCp<-roc(prtest$Donated,predicted_perceptron)
> plot(ROCp)
> aucp<-auc(ROCp)
> aucp
Area under the curve: 0.603
> plot(ROCp)
> 